(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{12:function(e,t,a){},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(6),r=a.n(c),o=(a(12),a(2)),i=a.n(o),l=a(3),u=a(7),d="".concat("http://localhost:3001","/api/v1/"),b=function(){var e=Object(l.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d).concat(t),{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(l.a)(i.a.mark((function e(t,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(d).concat(t),{method:"PUT",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),h=Object(n.createContext)({}),p=a(4),f=function(e,t){switch(t.type){case"SET_BOOKINGS":return Object(p.a)(Object(p.a)({},e),{},{total_seats_available:t.payload.total_seats_available,booked_seats:t.payload.booked_seats,coach_id:t.payload.coach_id});case"SET_NEW_BOOKINGS":return Object(p.a)(Object(p.a)({},e),{},{newly_booked_seats:t.payload.newly_booked_seats})}},_=a(0),v=function(e){for(var t=[],a=0;a<12;a++)t.push([]);var s={coach_id:"",total_seats_available:80,booked_seats:t,newly_booked_seats:t},c=Object(n.useReducer)(f,s),r=Object(u.a)(c,2),o=r[0],d=r[1],p=function(){var e=Object(l.a)(i.a.mark((function e(t){var a,n,s,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={required_seats:t},e.next=3,j("book_seats/".concat(o.coach_id),a);case 3:if(n=e.sent,console.log(n),!0!==(null===n||void 0===n?void 0:n.success)){e.next=12;break}return s=n.data.coach.total_seats_available,c=n.data.coach.booked_seats,r=String(n.data.coach._id),d({type:"SET_BOOKINGS",payload:{total_seats_available:s,booked_seats:c,coach_id:r}}),d({type:"SET_NEW_BOOKINGS",payload:{newly_booked_seats:n.data.newly_booked_seats}}),e.abrupt("return");case 12:alert("Something went wrong");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(l.a)(i.a.mark((function e(){var a,n,s,c,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={total_seats_available:80,booked_seats:t},e.next=3,j("refresh_bookings/".concat(o.coach_id),a);case 3:if(!0!==(null===(n=e.sent)||void 0===n?void 0:n.success)){e.next=11;break}return s=n.data.total_seats_available,c=n.data.booked_seats,r=String(n.data._id),d({type:"SET_BOOKINGS",payload:{total_seats_available:s,booked_seats:c,coach_id:r}}),d({type:"SET_NEW_BOOKINGS",payload:{newly_booked_seats:t}}),e.abrupt("return");case 11:alert("Something went wrong");case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(l.a)(i.a.mark((function e(){var t,a,n,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b("check_availability");case 2:if(!0!==(null===(t=e.sent)||void 0===t?void 0:t.success)){e.next=9;break}return a=t.data.total_seats_available,n=t.data.booked_seats,s=String(t.data._id),d({type:"SET_BOOKINGS",payload:{total_seats_available:a,booked_seats:n,coach_id:s}}),e.abrupt("return");case 9:alert("Something went wrong");case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(_.jsx)(h.Provider,{value:{total_seats_available:o.total_seats_available,booked_seats:o.booked_seats,newly_booked_seats:o.newly_booked_seats,handleBookTickets:p,handleGetTickets:O,handleRefreshTickets:v},children:e.children})},O=function(e){var t=Object(n.useContext)(h),a=t.handleBookTickets,s=t.total_seats_available,c=(t.coach_id,Object(n.useRef)(null)),r=function(){var e=Object(l.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(c.current.value>s)){e.next=4;break}return alert("Please enter a valid number"),e.abrupt("return");case 4:return console.log(null===c||void 0===c||null===(n=c.current)||void 0===n?void 0:n.value),e.next=7,a(null===c||void 0===c||null===(r=c.current)||void 0===r?void 0:r.value);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsxs)("div",{className:"book-tickets",children:[Object(_.jsxs)("h5",{children:[s," seats are available"]}),Object(_.jsxs)("form",{onSubmit:r,className:"main-form",children:[Object(_.jsx)("input",{ref:c,defaultValue:1,type:"number",max:80,min:1,className:"seats-input"}),Object(_.jsx)("button",{type:"submit",children:"Book"})]})]})},x=function(e){var t=e.num,a=(e.row,Object(n.useContext)(h)),s=a.booked_seats,c=a.newly_booked_seats;return Object(_.jsx)("div",{className:"row-section",children:11!==t?[1,2,3,4,5,6,7].map((function(e,a){return Object(_.jsx)("div",{className:"seat ".concat(c[t].indexOf(e)>-1?"selected-seat":s[t].indexOf(e)>-1?"filled-seat":"empty-seat"),children:Object(_.jsx)("span",{className:"seat-number",children:7*t+e})},a)})):[1,2,3].map((function(e,a){return Object(_.jsx)("div",{className:"seat ".concat(c[t].indexOf(e)>-1?"selected-seat":s[t].indexOf(e)>-1?"filled-seat":"empty-seat"),children:Object(_.jsx)("span",{className:"seat-number",children:7*t+e})},a)}))})},m=function(e){var t=Object(n.useContext)(h).booked_seats;return Object(_.jsxs)("div",{className:"coach-section",children:[Object(_.jsx)("h5",{children:"Train Coach"}),Object(_.jsxs)("div",{className:"signs",children:[Object(_.jsxs)("div",{className:"sign",children:[Object(_.jsx)("div",{className:"empty-circle"}),Object(_.jsx)("span",{className:"sign-text",children:"Empty Seats"})]}),Object(_.jsxs)("div",{className:"sign",children:[Object(_.jsx)("span",{className:"booked-circle"}),Object(_.jsx)("span",{className:"sign-text",children:"Booked Seats"})]}),Object(_.jsxs)("div",{className:"sign",children:[Object(_.jsx)("span",{className:"selected-circle"}),Object(_.jsx)("span",{className:"sign-text",children:"Selected Seats"})]})]}),Object(_.jsx)("div",{className:"train-coach",children:Object(_.jsx)("div",{className:"seats-section",children:t.map((function(e,t){return Object(_.jsx)(x,{num:t,row:e},t)}))})})]})},k=function(e){return Object(_.jsxs)("div",{className:"main-content",children:[Object(_.jsx)("div",{className:"book-ticket",children:Object(_.jsx)(O,{})}),Object(_.jsx)("div",{className:"coach-section",children:Object(_.jsx)(m,{})})]})},y=function(e){var t=e.brand,a=Object(n.useContext)(h).handleRefreshTickets;return Object(_.jsxs)("div",{className:"navbar",children:[Object(_.jsx)("h2",{className:"navbar-brand",children:t}),Object(_.jsx)("button",{className:"refresh-button",onClick:function(e){e.preventDefault(),a()},children:"Refresh Coach"})]})},N=function(e){var t=Object(n.useContext)(h).handleGetTickets;return Object(n.useEffect)((function(){t()}),[]),Object(_.jsxs)("div",{className:"homepage",children:[Object(_.jsx)(y,{brand:"Ticket Booking"}),Object(_.jsx)(k,{})]})};a(15);var w=function(){return Object(_.jsx)(v,{children:Object(_.jsx)("div",{className:"App",children:Object(_.jsx)(N,{})})})},g=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,17)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))};r.a.render(Object(_.jsx)(s.a.StrictMode,{children:Object(_.jsx)(w,{})}),document.getElementById("root")),g()}},[[16,1,2]]]);
//# sourceMappingURL=main.46a91ad1.chunk.js.map